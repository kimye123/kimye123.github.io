<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>전자폐기물 재활용 + 폐기 장소 찾기</title>
  <style>
    body { font-family: sans-serif; margin: 20px; background: #f5f5f5; }
    h1 { text-align: center; }
    input, button { padding: 8px; margin: 5px; }
    .keywords button {
      margin: 4px;
      padding: 6px 12px;
      border: 1px solid #333;
      border-radius: 16px;
      cursor: pointer;
      background: #fff;
    }
    .keywords button.active {
      background: #007BFF;
      color: #fff;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      overflow: hidden;
      cursor: pointer;
    }
    .card img { width: 100%; height: 200px; object-fit: cover; }
    .card h3 { margin: 10px; }

    .detail {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-top: 20px;
    }

    /* 지도 박스 스타일 */
    #map-container {
      margin-top: 40px;
    }
    #map {
      width: 100%;
      height: 400px;
      border: 1px solid #ccc;
    }
    .location-list {
      margin-top: 10px;
    }
    .location-item {
      padding: 8px;
      background: #fff;
      margin-bottom: 5px;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .location-item:hover {
      background: #f0f0f0;
    }
  </style>
</head>
<body>
  <h1>전자폐기물 재활용</h1>
  <p style="text-align:center;">검색창에 입력하거나 아래 키워드를 눌러보세요.</p>

  <div style="text-align:center;">
    <input id="search" type="text" placeholder="예: 스마트폰, 노트북, 배터리">
    <button onclick="resetSearch()">초기화</button>
  </div>

  <div class="keywords" id="keywords" style="text-align:center;"></div>

  <h2>검색 결과</h2>
  <div class="grid" id="results"></div>

  <div id="detail"></div>

  <!-- 폐기 장소 지도 영역 -->
  <div id="map-container">
    <h2>폐기 장소 찾기 (경기도)</h2>
    <div id="map"></div>
    <div class="location-list" id="location-list"></div>
  </div>

  <script>
    const DATA = [
      {
        id: 1,
        name: "스마트폰 (Smartphone)",
        keywords: ["스마트폰","휴대폰","폰","모바일"],
        image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?q=80&w=1200",
        recyclingMethod: "배터리는 분리 배출하고, 내부 회로/모듈은 전문 재활용 업체에서 금속(금,은,구리 등)과 희토류를 회수합니다.",
        resources: ["금 (Au)", "은 (Ag)", "구리 (Cu)", "희토류", "리튬 (Li)"]
      },
      {
        id: 2,
        name: "노트북 (Laptop)",
        keywords: ["노트북","랩탑","컴퓨터"],
        image: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=1200",
        recyclingMethod: "배터리와 HDD/SSD를 분리하고, 메인보드에서 귀금속과 구리를 회수합니다.",
        resources: ["구리 (Cu)", "금 (Au)", "은 (Ag)", "알루미늄 (Al)", "리튬 (Li)"]
      },
      {
        id: 3,
        name: "배터리 (Battery)",
        keywords: ["배터리","리튬","Li-ion"],
        image: "https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1200",
        recyclingMethod: "전문 업체로 안전하게 중화·재제조하고 리튬, 코발트, 니켈을 회수합니다.",
        resources: ["리튬 (Li)", "코발트 (Co)", "니켈 (Ni)"]
      }
    ];

    const searchInput = document.getElementById("search");
    const resultsDiv = document.getElementById("results");
    const detailDiv = document.getElementById("detail");
    const keywordsDiv = document.getElementById("keywords");
    let activeKeywords = [];

    const allKeywords = [...new Set(DATA.flatMap(d => d.keywords))];
    allKeywords.forEach(kw => {
      const btn = document.createElement("button");
      btn.textContent = kw;
      btn.onclick = () => {
        btn.classList.toggle("active");
        if (activeKeywords.includes(kw)) {
          activeKeywords = activeKeywords.filter(k => k !== kw);
        } else {
          activeKeywords.push(kw);
        }
        render();
      };
      keywordsDiv.appendChild(btn);
    });

    function matches(item) {
      const q = searchInput.value.trim().toLowerCase();
      const matchQuery = q === "" || item.name.toLowerCase().includes(q) || item.keywords.some(k => k.includes(q));
      const matchKeywords = activeKeywords.length === 0 || activeKeywords.every(kw => item.keywords.includes(kw) || item.name.includes(kw));
      return matchQuery && matchKeywords;
    }

    function render() {
      resultsDiv.innerHTML = "";
      detailDiv.innerHTML = "";
      const results = DATA.filter(matches);
      if (results.length === 0) {
        resultsDiv.textContent = "검색 결과가 없습니다.";
        return;
      }
      results.forEach(item => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `<img src="${item.image}"><h3>${item.name}</h3>`;
        card.onclick = () => showDetail(item);
        resultsDiv.appendChild(card);
      });
    }

    function showDetail(item) {
      detailDiv.innerHTML = `
        <div class="detail">
          <h2>${item.name}</h2>
          <img src="${item.image}" style="width:200px;border-radius:10px;"><br><br>
          <p><strong>재활용 방법:</strong> ${item.recyclingMethod}</p>
          <h3>회수 가능한 자원</h3>
          <ul>${item.resources.map(r => `<li>${r}</li>`).join("")}</ul>
          <button onclick="detailDiv.innerHTML=''">닫기</button>
        </div>
      `;
    }

    function resetSearch() {
      searchInput.value = "";
      activeKeywords = [];
      Array.from(keywordsDiv.children).forEach(btn => btn.classList.remove("active"));
      render();
    }

    searchInput.addEventListener("input", render);
    render();

    // ---------------- 폐기 장소 지도 및 목록 ----------------

    // 예시 장소 데이터 (경기도)
    const LOCS = [
      {
        name: "광명시 자원순환과 무상 수거 서비스",
        lat: 37.478,   // 예시 위도
        lng: 126.867,  // 예시 경도
        address: "경기도 광명시 ○○동 ○○ 번지",
        description: "거주형태별 맞춤 무상 수거, E-순환거버넌스 통해 신청 가능. 콜센터 1599‑0903."  // 예시 설명
      },
      {
        name: "남양주시 무상 폐가전 방문 수거센터",
        lat: 37.638,  
        lng: 127.217,  
        address: "경기도 남양주시 ○○구 ○○동",
        description: "냉장고, 세탁기, TV 등 대형 가전 포함. 홈페이지 또는 전화로 무료 방문 수거 신청 가능."  
      },
      {
        name: "용인시 폐가전 무상 수거 센터",
        lat: 37.240,  
        lng: 127.177,  
        address: "경기도 용인시 ○○구 ○○동",
        description: "E-순환거버넌스 예약 가능. 소형 및 대형 폐가전 수거."  
      },
      {
        name: "수원시 폐가전 자원회수시설",
        lat: 37.300,  
        lng: 127.000,
        address: "경기도 수원시 ○○구 ○○동",
        description: "공공 집하장 또는 지정 장소 배출, 또는 방문 수거 신청 가능."  
      }
    ];

    // 지도 API 사용 예: 구글 지도 또는 카카오 지도 등
    // 여기서는 단순히 지도 플러그인 없이 마커만 흉내내는 예
    // 실제 서비스하면 지도 API (예: Kakao Maps, Google Maps)로 대체

    function initMap() {
      const mapDiv = document.getElementById("map");
      mapDiv.innerHTML = "";  // 초기화
      // 지도 영역에 기본 틀
      const info = document.createElement("div");
      info.style.position = "relative";
      info.style.width = "100%";
      info.style.height = "100%";
      mapDiv.appendChild(info);

      // 단순히 목록 기반 클릭으로 장소 표시
      const listDiv = document.getElementById("location-list");
      LOCS.forEach((loc, idx) => {
        const item = document.createElement("div");
        item.className = "location-item";
        item.textContent = loc.name;
        item.onclick = () => showLocationDetail(loc);
        listDiv.appendChild(item);
      });
    }

    function showLocationDetail(loc) {
      detailDiv.innerHTML = `
        <div class="detail">
          <h2>${loc.name}</h2>
          <p><strong>주소:</strong> ${loc.address}</p>
          <p><strong>설명:</strong> ${loc.description}</p>
          <button onclick="detailDiv.innerHTML=''">닫기</button>
        </div>
      `;
      // 지도 마커 표시나 지도 중심 이동 등의 기능 여기에 추가 가능
    }

    // 초기화
    initMap();

  </script>
</body>
</html>
